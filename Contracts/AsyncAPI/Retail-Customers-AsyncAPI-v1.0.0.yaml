asyncapi: '2.0.0'
defaultContentType: application/json
info:
  title: Retail Customers Service
  version: 1.0.0
  description: Messaging API for the Retail Customers service, handling customer-related events and notifications

channels:
  "inventorydomain.topic.exchange/inventory.updated.event":
    subscribe:
      message:
        oneOf:
          - $ref: "#/components/messages/InventoryUpdatedEvent"

components:
  messages:
    InventoryUpdatedEvent:
      # removed messageId to satisfy validator for 2.0.0
      payload:
        type: object
        required:
          - id
          - customerId
          - orderId
          - orderDate
          - totalAmount
          - lineItems
        properties:
          id:
            type: integer
            format: int64
            description: Unique identifier of the event
          customerId:
            type: integer
            format: int64
            description: Unique identifier of the customer who placed the order
          orderId:
            type: integer
            format: int64
            description: Unique identifier of the order
          orderDate:
            type: string
            format: date-time
            description: Date and time when the order was created
          totalAmount:
            type: number
            description: Total amount of the order
            minimum: 0
          lineItems:
            type: array
            description: List of items in the order
            items:
              $ref: "#/components/schemas/LineItem"
            minItems: 1

  schemas:
    LineItem:
      type: object
      required:
        - id
        - orderId
        - skuId
        - qty
      properties:
        id:
          type: integer
          format: int64
          description: Unique identifier of the line item
        orderId:
          type: integer
          format: int64
          description: Unique identifier of the order
        skuId:
          type: integer
          format: int64
          description: Unique identifier of the product SKU
        qty:
          type: integer
          description: Quantity of the product ordered
          minimum: 1